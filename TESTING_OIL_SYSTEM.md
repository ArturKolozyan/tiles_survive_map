# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –Ω–µ—Ñ—Ç–∏

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **–ü–æ–ª—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ—Ñ—Ç–∏** –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤:
   - `state.mapSettings.totalOil` - –æ–±—â–∞—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –Ω–µ—Ñ—Ç—å
   - `state.mapSettings.lastOilUpdate` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—á–∏—Å–ª–æ –¥–Ω–µ–π —Å –Ω–∞—á–∞–ª–∞)

2. **–õ–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ—Ñ—Ç–∏** (`static/js/ui.js`):
   - –§—É–Ω–∫—Ü–∏—è `checkAndUpdateDailyOil()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
   - –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ 00:00 UTC –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è
   - –°—á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∏ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏
   - –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–µ—Ñ—Ç–∏

3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON** (`maps/json_storage.py`):
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `total_oil` –∏ `last_oil_update`
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —ç—Ç–∏ –ø–æ–ª—è

4. **API —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** (`static/js/api.js`):
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `totalOil` –∏ `lastOilUpdate`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –ø–µ—Ä–µ–¥–∞–µ—Ç —ç—Ç–∏ –ø–æ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   - –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –∫–æ–≥–¥–∞ –∫–∞—Ä—Ç–∞ –∑–∞–ø—É—â–µ–Ω–∞

5. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∏–≥—Ä–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**:
   - –û–±—â–∞—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –Ω–µ—Ñ—Ç—å
   - –î–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥ –Ω–µ—Ñ—Ç–∏
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –≤—ã—à–µ–∫
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤
   - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –Ω–µ—Ñ—Ç–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://127.0.0.1:8000/
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–µ–∫ —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ—Ñ—Ç–∏
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `unlockDay = 0` –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è
5. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ —Ä–µ–∂–∏–º "–ò–≥—Ä–∞" (üéÆ)
6. –û—Ç–º–µ—Ç—å—Ç–µ —Ç–æ—á–∫–∏ –∫–∞–∫ "–ó–∞—Ö–≤–∞—á–µ–Ω–æ"
7. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞—Ç—É —Å—Ç–∞—Ä—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å)
8. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞—Ä—Ç—É
9. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ—Ñ—Ç—å –Ω–∞—á–∏—Å–ª–∏–ª–∞—Å—å –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

### –¢–µ—Å—Ç 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞
1. –ü–æ—Å–ª–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –Ω–µ—Ñ—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞—Ä—Ç—É
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â—É—é –∫–∞—Ä—Ç—É
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –Ω–µ—Ñ—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å

### –¢–µ—Å—Ç 3: –û—Ç–∫—Ä—ã—Ç–∏–µ —Ç–æ—á–µ–∫ –ø–æ —Ç–∞–π–º–µ—Ä—É
1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–æ—á–∫–∏ —Å `unlockDay > 0`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞—Ä—Ç—É
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–∫—Ä—ã—Ç—ã–µ —Ç–æ—á–∫–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –¥–Ω–µ–≤–Ω–æ–º –¥–æ—Ö–æ–¥–µ
4. –ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ç–æ—á–∫–∏ –∏ –∑–∞—Ö–≤–∞—Ç–∞ –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞—á–∞—Ç—å –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –Ω–µ—Ñ—Ç—å

### –¢–µ—Å—Ç 4: –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞—Ä—Ç—É
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30+ —Å–µ–∫—É–Ω–¥
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –≤ `map_data/` - –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –¥–∞—Ç–∞ `updated_at`

## –§–æ—Ä–º—É–ª–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è

```
–î–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥ = –°—É–º–º–∞ –Ω–µ—Ñ—Ç–∏ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫
–û–±—â–∞—è –Ω–µ—Ñ—Ç—å += –î–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥ √ó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—à–µ–¥—à–∏—Ö –¥–Ω–µ–π
```

## –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞

–î–µ–Ω—å 0 (—Å—Ç–∞—Ä—Ç):
- –ó–∞—Ö–≤–∞—á–µ–Ω–æ 3 —Ç–æ—á–∫–∏: 100 + 100 + 100 = 300 –Ω–µ—Ñ—Ç–∏/–¥–µ–Ω—å
- –û–±—â–∞—è –Ω–µ—Ñ—Ç—å: 0

–î–µ–Ω—å 1 (00:00 UTC):
- –ù–∞—á–∏—Å–ª–µ–Ω–æ: 300 –Ω–µ—Ñ—Ç–∏
- –û–±—â–∞—è –Ω–µ—Ñ—Ç—å: 300

–î–µ–Ω—å 2 (00:00 UTC):
- –ó–∞—Ö–≤–∞—á–µ–Ω–æ –µ—â–µ 3 —Ç–æ—á–∫–∏: 200 + 200 + 200 = 600 –Ω–µ—Ñ—Ç–∏/–¥–µ–Ω—å
- –î–Ω–µ–≤–Ω–æ–π –¥–æ—Ö–æ–¥ —Ç–µ–ø–µ—Ä—å: 300 + 600 = 900 –Ω–µ—Ñ—Ç–∏/–¥–µ–Ω—å
- –ù–∞—á–∏—Å–ª–µ–Ω–æ: 900 –Ω–µ—Ñ—Ç–∏
- –û–±—â–∞—è –Ω–µ—Ñ—Ç—å: 300 + 900 = 1200

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

- –ù–µ—Ñ—Ç—å –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–æ—á–µ–∫ (unlockDay –ø—Ä–æ—à–µ–ª)
- –ù–µ—Ñ—Ç—å –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ (status = 'captured')
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–≥–æ –≤ 00:00 UTC
- –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∫–∞—Ä—Ç—ã –≤—Å—è –Ω–µ—Ñ—Ç—å —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–µ—Ñ—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
